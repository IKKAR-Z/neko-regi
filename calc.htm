<html lang="ja">
	<head>
	<meta charset="utf-8">
	<meta name="viewport"
   		content="width=device-width,
		,user-scalable=no" />
	<style type="text/css">
		<!--
		body{
			user-select: none;
		}
		.srider{
			display: flex;
			justify-content: flex-end;
		}
		h1{
			display: flex;
			justify-content: space-around;
		}
		h1 + a{
			font-size: xx-large;
		}
		.area{
			display: flex;
			flex-flow: column wrap;
			list-style-type: none;
			height: 50rem;
		}
		
		.tab_class {
			width: calc(100%/3);
			height: 50px;
			background-color: darkgrey;
			line-height: 50px;
			font-size: 15px;
			text-align: center;
			display: block;
			float: left;
			order: -1;
			//タブ部の書式
		}

		input[name="tab_name"] {
			display: none;
			//ラジオボタン◎を非表示にする
		}

		input:checked + .tab_class {
			background-color: cadetblue;
			color: aliceblue;
			//タブが選択された時の書式
		}

		.content_class {
			display: none;
			width: 100%;
			//タブの中身を非表示に
		}

		input:checked + .tab_class + .content_class {
			display: block;
			//選択されたタブの中身を表示に
		}

		-->
	</style>
	</head>
	<body>
		<hr>
		<h1>
			<input type="button" value="消去" onclick="reset()"><a id="msg">&yen;0</a>
		</h1>
		<hr>
		
		<div class="area" id="area1">
			<input type="radio" name="tab_name" id="tab1" checked>
			<label class="tab_class" for="tab1">フード</label>
			<div class="content_class" id="food_menu">

			</div>
			<input type="radio" name="tab_name" id="tab2" >
			<label class="tab_class" for="tab2">ドリンク</label>
			<div class="content_class" id="drink_menu">

			</div>
			<input type="radio" name="tab_name" id="tab3" >
			<label class="tab_class" for="tab3">スペシャル</label>
			<div class="content_class" id="special">
				<p>スペシャル準備中</p>
			</div>
		</div>

		<!--
		<div id="area1" class="menu-list">
		</div>
		-->
		<datalist id="tickmarks">
			<option value="0"></option>
			<option value="4"></option>
			<option value="8"></option>
			<option value="12"></option>
			<option value="16"></option>
			<option value="20"></option>
		</datalist>
		
		<script>
			let nmax=0;

			let code0="<li><a id=\"food@\"></a><br><a id=\"price@\"></a> x <a id=\"n@\">0</a><br><a class=\"srider\"><input type=\"range\" id=\"quant@\" min=\"0\" max=\"20\" value=\"0\" step=\"1\" list=\"tickmarks\"></a><br></li>\n"

			// CSVファイルを取得
			let csv = new XMLHttpRequest();

			// CSVファイルへのパス
			csv.open("GET", "menu-list.csv", false);

			// csvファイル読み込み失敗時のエラー対応
			try {
				csv.send(null);
			} catch (err) {
				console.log(err);
			}

			// 配列を定義
			let csvArray = [];

			// 改行ごとに配列化
			let lines = csv.responseText.split(/\r\n|\n/);

			// 1行ごとに処理

			for (let i = 0; i < lines.length; ++i) {
				let cells = lines[i].split(",");
				if (cells.length != 1) {
					nmax++;
					let str = code0.split("@");
					if (cells[2]=="food"){
						food_menu.innerHTML=food_menu.innerHTML+str.join(i);
					}else if(cells[2]=="drink"){
						drink_menu.innerHTML=drink_menu.innerHTML+str.join(i);
					}
					eval('food'+i).innerText=cells[0];
					eval('price'+i).innerText=cells[1];

				}
			}

			area1.onchange = function calc(){
				let a = 0;
				for (var j=0, max=nmax; j<max; j++){
					let price = parseInt(document.getElementById('price'+j).innerText,10);
					let quant = parseInt(document.getElementById('quant'+j).value,10);
					a = a+price*quant;
				}

				msg.innerText=Intl.NumberFormat('ja-JP', { style: 'currency', currency: 'JPY' }).format(a);
			}
			function reset(){
				for (var k=0, max=nmax; k<max; k++){
					document.getElementById('quant'+k).value="0";
					eval('n'+k).innerText="0";
				}
				msg.innerText="\\0";
			}
			
			for (var i=0, max=nmax; i<max; i++){
				let elem = document.getElementById('quant'+i);
				let target = document.getElementById('n'+i);
				let rangeValue = function (elem, target) {
					return function(evt) {
						target.innerHTML = elem.value;
					}
				}
				elem.addEventListener('input', rangeValue(elem,target));
			}
			
		</script>
	</body>
</html>
